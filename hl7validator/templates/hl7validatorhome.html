<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>HL7 Validator</title>
    <link href="/static/bootstrap.min.css" rel="stylesheet" media="screen">

    <link href="/static/mystyle.css" rel="stylesheet" media="screen">

</head>

<body>
<div class="container-fluid px-5">
    <div class="row align-items-center">
        <div class="col-2">
            <img style="float:left; width:70%;" src="/static/hl7pt.png" class="rounded float-left" alt="HL7PT">
        </div>
        <div class="col-10">
            <h1>Validator HL7 V2 <a style="font-size:x-small">Versão: {{version}}</a></h1>
        </div>

    </div>

    <form method="POST" role="form">
        <div class="form-group">
            <label for="exampleFormControlTextarea1">
                <h3>Usa o formulário abaixo para validar uma mensagem HL7 v2 ou converter para CSV</h3>
            </label>

            <div class="row align-items-center">
                <div class="col-lg-2 "><label class="radio-inline"><input type="radio" name="options" value="hl7v2"
                                                                          checked> HL7
                    V2</label></div>
               
                <div class="col-lg-3">
                    <label class="radio-inline"><input type="radio" name="options" value="converter">Converter HL7 V2 para CSV</label>
                </div>
            </div>
            <textarea class="form-control" id="exampleFormControlTextarea1" name="msg" rows="7">{{ msg }}</textarea>
        </div>
        <button type="submit" class="btn btn-primary">Submeter</button>
        <button type="button" class="btn btn-secondary" onclick="clearContent()">Apagar</button>
        <p>Usar como API? ver <a href="/apidocs">aqui</a>. 
            <br>
            Algum erro detetado? Por favor enviar email para <a href="mailto:tech@hl7.pt">tech [at] hl7.pt</a></p>

    </form>
    <br>

    {% if title %}
    <h2>{{ title }}</h2>
    {% endif %}
    {% if parsed %}

        <p>
          <a class="btn btn-primary" data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
            Clicar para ver mensagem estruturada
          </a>
        </p>
        <div class="collapse" id="collapseExample">
          <div class="card card-body">
            {% if hl7version %}
            <p>Para mais informações, ver a especificação <a href="https://hl7-definition.caristix.com/v2/HL7v{{hl7version}}" target="_blank"> da versão {{hl7version}} aqui</a>. Ou Clica no identificador do segmento para ver a especificação.</p>
            {% endif %}
            {{parsed|safe}}

          </div>
        </div>

      <br>
    {% endif %}
   

    {% if result %}

    <table class="table">
        <thead>
        <tr>
            <th scope="col">#</th>

            <th scope="col">Level</th>
            <th scope="col">Message</th>

        </tr>
        </thead>
        <tbody>
        {% for foo in result %}
        <tr >
            <th scope="row">{{loop.index}}</th>

            <td class="{{foo["level"]}}level">{{ foo["level"] }}</td>
            <td>{{ foo["message"] }}</td>

        </tr>
        {% endfor %}
        </tbody>
    </table>

    {% endif %}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

</body>
<footer>
</footer>
<script>
    function clearContent() {
        document.getElementById('exampleFormControlTextarea1').value = '';
    }
    </script>
</html>